"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toolbar=exports.registerToolbarComponent=void 0;var react_1=__importDefault(require("react")),mobx_react_lite_1=require("mobx-react-lite"),core_1=require("@blueprintjs/core"),MdOpacity_1=__importDefault(require("@meronex/icons/md/MdOpacity")),math_1=require("../utils/math"),text_toolbar_1=__importDefault(require("./text-toolbar")),image_toolbar_1=__importDefault(require("./image-toolbar")),svg_toolbar_1=__importDefault(require("./svg-toolbar")),download_button_1=__importDefault(require("./download-button")),ComponentsTypes={text:text_toolbar_1.default,image:image_toolbar_1.default,svg:svg_toolbar_1.default};function registerToolbarComponent(e,t){ComponentsTypes[e]=t}exports.registerToolbarComponent=registerToolbarComponent,exports.Toolbar=mobx_react_lite_1.observer((function(e){var t,o,n=e.store,a=e.downloadButtonEnabled,l=e.hideOpacity,r=e.hideTextSpacing,c=e.hideTextEffects,i=n.selectedElements.length>0,d=1===n.selectedElements.length,s=n.selectedElements[0],u=(null===(t=n.activePage)||void 0===t?void 0:t.children.indexOf(s))||0,m=n.activePage&&u<n.activePage.children.length-1,_=u>0,f=d&&ComponentsTypes[s.type],p=d&&s._cropModeEnabled;return react_1.default.createElement(core_1.Navbar,null,!p&&react_1.default.createElement(core_1.Navbar.Group,{align:core_1.Alignment.LEFT},react_1.default.createElement(core_1.Button,{icon:"undo",minimal:!0,onClick:function(){n.history.undo()},disabled:!n.history.canUndo}),react_1.default.createElement(core_1.Button,{icon:"redo",minimal:!0,onClick:function(){n.history.redo()},disabled:!n.history.canRedo})),f&&react_1.default.createElement(f,{store:n,hideTextSpacing:r,hideTextEffects:c}),!p&&react_1.default.createElement(core_1.Navbar.Group,{align:core_1.Alignment.RIGHT},react_1.default.createElement(core_1.Popover,{disabled:!i,content:react_1.default.createElement(core_1.Menu,null,react_1.default.createElement(core_1.Menu.Divider,{title:"Layering"}),react_1.default.createElement(core_1.MenuItem,{shouldDismissPopover:!1,icon:"double-chevron-up",text:"To forward",disabled:!m,onClick:function(){s.moveTop()}}),react_1.default.createElement(core_1.MenuItem,{shouldDismissPopover:!1,icon:"chevron-up",text:"Up",disabled:!m,onClick:function(){s.moveUp()}}),react_1.default.createElement(core_1.MenuItem,{shouldDismissPopover:!1,icon:"chevron-down",text:"Down",disabled:!_,onClick:function(){s.moveDown()}}),react_1.default.createElement(core_1.MenuItem,{shouldDismissPopover:!1,icon:"double-chevron-down",text:"To bottom",disabled:!_,onClick:function(){s.moveBottom()}}),react_1.default.createElement(core_1.Menu.Divider,{title:"Position"}),react_1.default.createElement(core_1.MenuItem,{shouldDismissPopover:!1,icon:"alignment-top",text:"Align top",onClick:function(){var e=n.height;n.selectedElements.forEach((function(t){e=Math.min(e,math_1.getClientRect(t).y)})),n.selectedElements.forEach((function(t){t.set({y:t.y-e})}))}}),react_1.default.createElement(core_1.MenuItem,{shouldDismissPopover:!1,icon:"alignment-left",text:"Align left",onClick:function(){var e=n.width;n.selectedElements.forEach((function(t){e=Math.min(e,math_1.getClientRect(t).x)})),n.selectedElements.forEach((function(t){t.set({x:t.x-e})}))}}),react_1.default.createElement(core_1.MenuItem,{shouldDismissPopover:!1,icon:"alignment-right",text:"Align right",onClick:function(){var e=0;n.selectedElements.forEach((function(t){var o=math_1.getClientRect(t);e=Math.max(e,o.x+o.width)})),n.selectedElements.forEach((function(t){math_1.getClientRect(t);t.set({x:t.x+n.width-e})}))}}),react_1.default.createElement(core_1.MenuItem,{shouldDismissPopover:!1,icon:"alignment-bottom",text:"Align bottom",onClick:function(){var e=0;n.selectedElements.forEach((function(t){var o=math_1.getClientRect(t);e=Math.max(e,o.y+o.height)})),n.selectedElements.forEach((function(t){math_1.getClientRect(t);t.set({y:t.y+n.height-e})}))}})),position:core_1.Position.BOTTOM},react_1.default.createElement(core_1.Button,{icon:"layers",minimal:!0,text:"Position",disabled:!i})),!l&&react_1.default.createElement(core_1.Popover,{disabled:!i,content:react_1.default.createElement("div",{style:{padding:"10px 20px"}},react_1.default.createElement("div",{style:{textAlign:"center"}},"Transparency"),react_1.default.createElement(core_1.Slider,{value:100*(null===(o=n.selectedElements[0])||void 0===o?void 0:o.opacity),labelRenderer:!1,onChange:function(e){n.selectedElements.forEach((function(t){t.set({opacity:e/100})}))},min:0,max:100})),position:core_1.Position.BOTTOM},react_1.default.createElement(core_1.Tooltip,{content:"Transparency",disabled:!i},react_1.default.createElement(core_1.Button,{minimal:!0,disabled:!i},react_1.default.createElement(MdOpacity_1.default,{className:"bp3-icon",style:{fontSize:"20px"}})))),react_1.default.createElement(core_1.Tooltip,{content:"Duplicate elements",disabled:!i},react_1.default.createElement(core_1.Button,{icon:"duplicate",minimal:!0,onClick:function(){n.selectedElements.forEach((function(e){e.clone({x:e.x+50,y:e.y+50})}))},disabled:!i})),react_1.default.createElement(core_1.Tooltip,{content:"Remove elements",disabled:!i},react_1.default.createElement(core_1.Button,{icon:"trash",minimal:!0,onClick:function(){n.deleteElements(n.selectedElementsIds)},disabled:!i,style:{marginLeft:"auto"}})),a&&react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.Divider,{style:{height:"100%",margin:"0 15px"}}),react_1.default.createElement(download_button_1.default,{store:n}))))})),exports.default=exports.Toolbar;